<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>
    
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        body {
            font-family: sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            flex-direction: column; /* –î–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –≤—Å–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ */
        }
        
        .main-container {
            display: flex;
            gap: 20px;
            max-width: 900px;
            width: 90%;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (Mobile First) */
        .calculator, .notes-area {
            width: 100%;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (—à–∏—Ä–∏–Ω–∞ –¥–æ 600px) */
        @media (max-width: 600px) {
            .main-container {
                flex-direction: column; /* –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏ –∑–∞–º–µ—Ç–∫–∏ –¥—Ä—É–≥ –ø–æ–¥ –¥—Ä—É–≥–æ–º */
                width: 95%;
            }
            .notes-area {
                margin-top: 20px;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–æ–≤ (—à–∏—Ä–∏–Ω–∞ –±–æ–ª–µ–µ 600px) */
        @media (min-width: 601px) {
            .calculator {
                width: 45%;
            }
            .notes-area {
                width: 55%;
                border-left: 1px solid #ccc;
                padding-left: 20px;
            }
        }

        /* –°—Ç–∏–ª–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ */
        #display {
            width: 100%;
            height: 50px;
            margin-bottom: 10px;
            font-size: 2em;
            text-align: right;
            border: 1px solid #ccc;
            padding: 5px;
            box-sizing: border-box;
        }

        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
        }

        .buttons button {
            padding: 15px;
            font-size: 1.2em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #e6e6e6;
            transition: background-color 0.1s;
        }

        .buttons button:hover {
            background-color: #d4d4d4;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤ */
        #mode-select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 1em;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–º–µ—Ç–æ–∫ (Canvas) */
        #drawing-canvas {
            border: 1px solid #000;
            cursor: crosshair; /* –ö—É—Ä—Å–æ—Ä –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è */
        }
    </style>
</head>
<body>

    <div class="main-container">
        
        <div class="calculator">
            <h2>üî¢ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h2>
            
            <select id="mode-select" onchange="changeMode(this.value)">
                <option value="basic">–ë–∞–∑–æ–≤—ã–π</option>
                <option value="mechanical">–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π</option>
                <option value="scientific">–ù–∞—É—á–Ω—ã–π</option>
            </select>

            <input type="text" id="display" readonly value="0">
            
            <div class="buttons" id="calc-buttons">
                <button onclick="clearDisplay()">AC</button>
                <button onclick="appendValue('(')">(</button>
                <button onclick="appendValue(')')">)</button>
                <button onclick="appendValue('/')">/</button>

                <button onclick="appendValue('7')">7</button>
                <button onclick="appendValue('8')">8</button>
                <button onclick="appendValue('9')">9</button>
                <button onclick="appendValue('*')">√ó</button>

                <button onclick="appendValue('4')">4</button>
                <button onclick="appendValue('5')">5</button>
                <button onclick="appendValue('6')">6</button>
                <button onclick="appendValue('-')">-</button>

                <button onclick="appendValue('1')">1</button>
                <button onclick="appendValue('2')">2</button>
                <button onclick="appendValue('3')">3</button>
                <button onclick="appendValue('+')">+</button>

                <button onclick="appendValue('0')">0</button>
                <button onclick="appendValue('.')">.</button>
                <button onclick="calculateResult()" style="grid-column: span 2; background-color: #4CAF50; color: white;">=</button>
            </div>
            
            <div id="mechanical-output" style="margin-top: 15px; display: none;">
                <p>–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—à–∞–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π...</p>
            </div>
        </div>

        <div class="notes-area">
            <h2>‚úçÔ∏è –ó–∞–º–µ—Ç–∫–∏/–°—Ç–∏–ª—É—Å</h2>
            <p>–†–∏—Å—É–π—Ç–µ –∑–¥–µ—Å—å. –í –±—É–¥—É—â–µ–º –ò–ò —Å–º–æ–∂–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –≤–∞—à–∏ –∑–∞–ø–∏—Å–∏!</p>
            <canvas id="drawing-canvas" width="400" height="200"></canvas>
            <button onclick="clearCanvas()" style="margin-top: 10px; padding: 8px;">–û—á–∏—Å—Ç–∏—Ç—å –ó–∞–º–µ—Ç–∫–∏</button>
            <button onclick="recognizeText()" style="margin-top: 10px; padding: 8px;">–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å (–ò–ò)</button>
            <div id="recognition-output" style="margin-top: 10px; border: 1px dashed #000; padding: 5px; min-height: 20px;"></div>
        </div>

    </div>

    <script>
        const display = document.getElementById('display');
        const canvas = document.getElementById('drawing-canvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;

        // --- –õ–û–ì–ò–ö–ê –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê ---

        function appendValue(value) {
            if (display.value === '0') {
                display.value = value;
            } else {
                display.value += value;
            }
        }

        function clearDisplay() {
            display.value = '0';
        }

        function calculateResult() {
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º eval() –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏.
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Math.js)
                let result = eval(display.value.replace(/√ó/g, '*'));
                display.value = result;
            } catch (e) {
                display.value = '–û—à–∏–±–∫–∞';
            }
        }

        function changeMode(mode) {
            const mechOutput = document.getElementById('mechanical-output');
            
            // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –¥–ª—è "–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–≥–æ" —Ä–µ–∂–∏–º–∞:
            // 1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –∫–Ω–æ–ø–æ–∫ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏).
            // 2. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ —Å–∫—Ä—ã—Ç–∏–µ –æ–±–ª–∞—Å—Ç–∏ –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞.
            
            mechOutput.style.display = 'none'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã–≤–∞–µ–º
            
            if (mode === 'basic') {
                // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –±–∞–∑–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
            } else if (mode === 'mechanical') {
                // –í —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ –ª–æ–≥–∏–∫–∞ `calculateResult` –¥–æ–ª–∂–Ω–∞ —Å—Ç–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π,
                // —á—Ç–æ–±—ã –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `eval()`, –∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ—à–∞–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏,
                // –∑–∞–ø–∏—Å—ã–≤–∞—è –∏—Ö –≤ `mechanical-output`.
                mechOutput.style.display = 'block';
            } else if (mode === 'scientific') {
                // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –Ω–∞—É—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (sin, cos, log, etc.)
            }
            
            display.value = '–†–µ–∂–∏–º: ' + mode;
        }


        // --- –õ–û–ì–ò–ö–ê –†–ò–°–û–í–ê–ù–ò–Ø (CANVAS) ---

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ Canvas –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏
        function resizeCanvas() {
            const notesArea = document.querySelector('.notes-area');
            canvas.width = notesArea.clientWidth - 2; // –£—á–∏—Ç—ã–≤–∞–µ–º –≥—Ä–∞–Ω–∏—Ü—ã
            canvas.height = 200; 
            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.strokeStyle = 'black';
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è
        canvas.addEventListener('mousedown', (e) => {
            isDrawing = true;
            [lastX, lastY] = [e.offsetX, e.offsetY];
        });
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', () => isDrawing = false);
        canvas.addEventListener('mouseout', () => isDrawing = false);

        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å—Ç–∏–ª—É—Å–∞/—Ç–∞—á—Å–∫—Ä–∏–Ω–∞
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
            isDrawing = true;
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            [lastX, lastY] = [touch.clientX - rect.left, touch.clientY - rect.top];
        }, { passive: false });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (!isDrawing) return;
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            draw({ offsetX: touch.clientX - rect.left, offsetY: touch.clientY - rect.top });
            [lastX, lastY] = [touch.clientX - rect.left, touch.clientY - rect.top];
        }, { passive: false });

        canvas.addEventListener('touchend', () => isDrawing = false);
        canvas.addEventListener('touchcancel', () => isDrawing = false);


        function draw(e) {
            if (!isDrawing) return;
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
            [lastX, lastY] = [e.offsetX, e.offsetY];
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            document.getElementById('recognition-output').innerText = '';
        }

        // --- –ü–†–û–í–ï–†–ö–ê –£–°–¢–†–û–ô–°–¢–í–ê –ò –ê–î–ê–ü–¢–ê–¶–ò–Ø –ò–ù–¢–ï–†–§–ï–ô–°–ê ---

        function checkDeviceAndAdapt() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ—Å—Ç—å:
            // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —à–∏—Ä–∏–Ω—É —ç–∫—Ä–∞–Ω–∞ (–ø—Ä–æ—Å—Ç–æ, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ç–æ—á–Ω–æ)
            // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ 'ontouchstart' (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ —Å–µ–Ω—Å–æ—Ä–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞)
            const isMobile = window.matchMedia("only screen and (max-width: 600px)").matches || 
                             ('ontouchstart' in window) || 
                             (navigator.maxTouchPoints > 0);
            
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è CSS-–∫–ª–∞—Å—Å–æ–≤
            // –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã HTML, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏.
            
            console.log(isMobile ? '–ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ' : '–ö–æ–º–ø—å—é—Ç–µ—Ä');
            
            // –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –∫–Ω–æ–ø–æ–∫.
        }

        window.onload = checkDeviceAndAdapt;
        window.addEventListener('resize', checkDeviceAndAdapt);


        // --- –ó–ê–ì–õ–£–®–ö–ê –î–õ–Ø –ò–ò –†–ê–°–ü–û–ó–ù–ê–í–ê–ù–ò–Ø ---

        function recognizeText() {
            // –í –†–ï–ê–õ–¨–ù–û–ú –ü–†–ò–õ–û–ñ–ï–ù–ò–ò: 
            // 1. –ü–æ–ª—É—á–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å canvas: `canvas.toDataURL('image/png')`
            // 2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, Tesseract.js –∏–ª–∏ web-–≤–µ—Ä—Å–∏—é –º–æ—â–Ω–æ–π –º–æ–¥–µ–ª–∏, –µ—Å–ª–∏ –æ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞)
            // 3. –ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.
            
            const output = document.getElementById('recognition-output');
            output.innerText = '‚è≥ –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è... (—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ—â–Ω—ã–π JS/—Å–µ—Ä–≤–µ—Ä–Ω–æ–µ API –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ò–ò)';
            
            // –ò–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            setTimeout(() => {
                output.innerText = '–†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: 12 + X = 30'; // –ü—Ä–∏–º–µ—Ä —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
                // –í –∏–¥–µ–∞–ª–µ, –µ—Å–ª–∏ —ç—Ç–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ, –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä:
                // display.value = '12+18'; // –ü—Ä–∏–º–µ—Ä –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
            }, 1500);
        }

    </script>

</body>
</html>
