<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Base64 –ú–µ–¥–∏–∞-–ü–ª–µ–µ—Ä</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .controls {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #ccc;
        }
        .controls label, .controls select, .controls input[type="file"], .controls button {
            display: block;
            margin-bottom: 10px;
            width: 100%;
            box-sizing: border-box;
        }
        .controls select, .controls input[type="file"] {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .controls button {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .controls button:hover {
            background-color: #0056b3;
        }
        #mediaDisplay {
            text-align: center;
        }
        #mediaDisplay * {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 15px auto;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Base64 –ú–µ–¥–∏–∞-–ü–ª–µ–µ—Ä üìΩÔ∏è</h2>
        <div class="controls">
            <label for="base64File">1. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å Base64 –∫–æ–¥–æ–º:</label>
            <input type="file" id="base64File" accept=".txt">

            <label for="mediaType">2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:</label>
            <select id="mediaType">
                <option value="image">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (Image)</option>
                <option value="video">–í–∏–¥–µ–æ (Video)</option>
                <option value="audio">–ê—É–¥–∏–æ (Audio)</option>
            </select>

            <button onclick="displayMedia()">–ü–æ–∫–∞–∑–∞—Ç—å –ö–æ–Ω—Ç–µ–Ω—Ç</button>
            <p id="message" style="color: red;"></p>
        </div>

        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
        <div id="mediaDisplay">
            </div>
    </div>

    <script>
        function getMimeType(mediaType) {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π MIME-—Ç–∏–ø
            switch (mediaType) {
                case 'image':
                    // –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–∞—Å—Ç–æ –ø–æ–¥—Ö–æ–¥—è—Ç jpeg, png, gif. –í—ã–±–∏—Ä–∞–µ–º –æ–±—â–∏–π, –Ω–æ –º–æ–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å
                    // –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ Base64, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å "data:..." MIME-—Ç–∏–ø —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω
                    // –ù–æ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –º—ã –¥–æ–ª–∂–Ω—ã –µ–≥–æ –¥–æ–±–∞–≤–∏—Ç—å. –î–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ –±–µ—Ä–µ–º data:image/jpeg;base64,...
                    return 'image/jpeg';
                case 'video':
                    return 'video/mp4'; // –ü—Ä–∏–º–µ—Ä
                case 'audio':
                    return 'audio/mp3'; // –ü—Ä–∏–º–µ—Ä
                default:
                    return '';
            }
        }

        function displayMedia() {
            const fileInput = document.getElementById('base64File');
            const mediaType = document.getElementById('mediaType').value;
            const displayArea = document.getElementById('mediaDisplay');
            const messageArea = document.getElementById('message');
            
            displayArea.innerHTML = '';
            messageArea.textContent = '';

            if (fileInput.files.length === 0) {
                messageArea.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª.';
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                try {
                    // Base64 –∫–æ–¥ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
                    let base64Code = e.target.result.trim();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —É–∂–µ –ø–æ–ª–Ω—ã–º Data URI (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å "data:")
                    const isDataURI = base64Code.toLowerCase().startsWith('data:');

                    let dataUri;
                    let mimeType = getMimeType(mediaType);
                    
                    if (isDataURI) {
                        // –ï—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ —É–∂–µ –µ—Å—Ç—å –ø–æ–ª–Ω—ã–π Data URI (–≤–∫–ª—é—á–∞—è MIME-—Ç–∏–ø)
                        dataUri = base64Code;
                        
                        // –ü–æ–ø—ã—Ç–∞–µ–º—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –ø–æ Data URI, —á—Ç–æ–±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≤ Select
                        const uriMime = dataUri.substring(5, dataUri.indexOf(';'));
                        if (!uriMime.includes(mediaType)) {
                             // –ù–µ —Å—Ç—Ä–æ–≥–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
                             messageArea.textContent += `–í–Ω–∏–º–∞–Ω–∏–µ: –í—ã–±—Ä–∞–Ω —Ç–∏–ø "${mediaType}", –Ω–æ —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç Base64 —Å MIME-—Ç–∏–ø–æ–º "${uriMime}". –ü–ª–µ–µ—Ä –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å. `;
                        }
                    } else {
                        // –ï—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–π Base64 –∫–æ–¥, –¥–æ–±–∞–≤–ª—è–µ–º Data URI –ø—Ä–µ—Ñ–∏–∫—Å
                        dataUri = `data:${mimeType};base64,${base64Code}`;
                    }

                    let mediaElement;

                    // –°–æ–∑–¥–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ–¥–∏–∞-—ç–ª–µ–º–µ–Ω—Ç
                    switch (mediaType) {
                        case 'image':
                            mediaElement = document.createElement('img');
                            mediaElement.src = dataUri;
                            mediaElement.alt = 'Base64 –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';
                            break;
                        case 'video':
                            mediaElement = document.createElement('video');
                            mediaElement.src = dataUri;
                            mediaElement.controls = true;
                            mediaElement.autoplay = false;
                            break;
                        case 'audio':
                            mediaElement = document.createElement('audio');
                            mediaElement.src = dataUri;
                            mediaElement.controls = true;
                            break;
                        default:
                            messageArea.textContent = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –º–µ–¥–∏–∞.';
                            return;
                    }
                    
                    displayArea.appendChild(mediaElement);
                    messageArea.textContent += '–ö–æ–Ω—Ç–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω.';
                    
                } catch (error) {
                    messageArea.textContent = `–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞: ${error.message}`;
                    console.error(error);
                }
            };

            reader.onerror = function(e) {
                messageArea.textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞.';
            };
            
            // –ß–∏—Ç–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∫–∞–∫ —Ç–µ–∫—Å—Ç
            reader.readAsText(file);
        }
    </script>
</body>
</html>
